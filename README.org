#+LATEX_HEADER: \usepackage[margin=1.5cm,includefoot]{geometry}
#+LATEX_HEADER: \usepackage[none]{hyphenat}
#+LATEX_HEADER: \usepackage{array}
#+LATEX_HEADER: \newcolumntype{$}{>{\global\let\currentrowstyle\relax}}
#+LATEX_HEADER: \newcolumntype{^}{>{\currentrowstyle}}
#+LATEX_HEADER: \newcommand{\rowstyle}[1]{\gdef\currentrowstyle{#1} #1\ignorespaces}
#+LATEX_HEADER: \usepackage{indentfirst}

#+OPTIONS: toc:nil title:nil

\begin{titlepage}
  \begin{center}
    \line(1,0){300} \\
    [5mm]
    \huge{\bfseries Differential Equations Coursework} \\
    \huge{\bfseries Aeroplane Landing Modelling} \\
    [5mm]
    \huge{Gleb Dianov} \\
  \end{center}
\end{titlepage}

\newpage

# \tableofcontents

\newpage

* Simplifying situation and setting up the model
** Given data

I've been given data about a landing aeroplane after touchdown. The mass of the aeroplane is $120 000$ kg. Initially air resistance slows the aeroplane and then, when it is slow enough, wheel brakes add a constant force to fully stop the aeroplane. The table below shows the aeroplane's speed, $v$ ms^{-1}, $t$ seconds after touchdown.

#+ATTR_LATEX: :align |rl|rl|
|----+----+----+----|
|  t |  v |  t |  v |
|----+----+----+----|
|  0 | 96 | 14 | 34 |
|  1 | 89 | 15 | 31 |
|  2 | 82 | 16 | 27 |
|  3 | 77 | 17 | 24 |
|  4 | 72 | 18 | 21 |
|  5 | 68 | 19 | 18 |
|  6 | 64 | 20 | 16 |
|  7 | 61 | 21 | 13 |
|  8 | 58 | 22 | 10 |
|  9 | 55 | 23 |  8 |
| 10 | 50 | 24 |  5 |
| 11 | 46 | 25 |  3 |
| 12 | 41 | 26 |  0 |
| 13 | 38 |    |    |
|----+----+----+----|

The image below shows a chart of the original data.

#+NAME: original_graph
[[./original_graph.png]]

** Modeling assumptions

- *The aeroplane can be modeled as a point particle*. This assumption allows us to negate any complex resistances that would occur. Modeling this way is appropriate because we are not given velocity (only speed) of the aeroplane at different points in time, so we are not interested in any rotations of the plane.
- *The runway can be modeled as a plane*. Without this assumption we would need to consider the possibility that the runway has a complex shape, for example it can have hills and/or pits.
- *The runway is horizontal*. Without this assumption we would need to include components of the weight and the reaction force in the model which would increase the complexity of the model and affect the calculations.
- *The aeroplane is moving in the horizontal plane*. This assumption allows us to negate any vertical forces.
- *The constant force from the wheel breaks (after the breaks are applied) and the air resistance are the only forces acting on the aeroplane in the horizontal plane*. This assumption allows us to say that any other resistance is negligible and there are no other forces, alternatively we can say that the air resistance model is a model of the total resistance force.
- *The given values for speed are rounded to the nearest integer*. This assumption allows the model of speed to have an error $\pm0.5$. It's very unlikely that the values of speed are exactly integers, so it's a reasonable assumption.
- *Breaks are applied at $t = 9$*. The table below shows differences between consecutive speed values, $\Delta v$, and differences between consecutive differences, $\Delta (\Delta v)$. $\Delta (\Delta v)$ is the lowest when $t = 10$. This means that the highest decrease of acceleration occurred between $t = 9$ and $t = 10$, hence we will assume that the breaks were applied during that time. We will model this as if the breaks were applied at $t = 9$.
- *Braking force starts working instantly*. This assumption makes acceleration not continuous and simplifies the calculations.

#+ATTR_LATEX: :mode math :environment bmatrix
#+NAME: table_of_differences
|----+----+----------+-------------------|
|  t |  v | \Delta v | \Delta (\Delta v) |
|----+----+----------+-------------------|
|  0 | 96 |          |                   |
|  1 | 89 |       -7 |                   |
|  2 | 82 |       -7 |                 0 |
|  3 | 77 |       -5 |                 2 |
|  4 | 72 |       -5 |                 0 |
|  5 | 68 |       -4 |                 1 |
|  6 | 64 |       -4 |                 0 |
|  7 | 61 |       -3 |                 1 |
|  8 | 58 |       -3 |                 0 |
|  9 | 55 |       -3 |                 0 |
| 10 | 50 |       -5 |                -2 |
| 11 | 46 |       -4 |                 1 |
| 12 | 41 |       -5 |                -1 |
| 13 | 38 |       -3 |                 2 |
| 14 | 34 |       -4 |                -1 |
| 15 | 31 |       -3 |                 1 |
| 16 | 27 |       -4 |                -1 |
| 17 | 24 |       -3 |                 1 |
| 18 | 21 |       -3 |                 0 |
| 19 | 18 |       -3 |                 0 |
| 20 | 16 |       -2 |                 1 |
| 21 | 13 |       -3 |                -1 |
| 22 | 10 |       -3 |                 0 |
| 23 |  8 |       -2 |                 1 |
| 24 |  5 |       -3 |                -1 |
| 25 |  3 |       -2 |                 1 |
| 26 |  0 |       -3 |                -1 |
|----+----+----------+-------------------|

** Derivation of the initial model

#+CAPTION: Forces diagram
[[./plane_diagram.png]]

The diagram shows the x-axis, direction of velocity, $v$, the air resistance, $f(v)$, and the constant braking force (when breaks are used), $B$.

$$ F = ma \mbox{ (Newton's second law)} $$
$$ F = \begin{cases} - f(v), & 0 \leq t < 9 \\ - f(v) - B, & 9 \leq t \leq 26 \end{cases} $$
$$ a = \dot{v} $$
$$ \Rightarrow \begin{cases} m\dot{v} = - f(v), & t < 9 \\ m\dot{v} = - f(v) - B, & t \geq 9 \end{cases} $$
$$ \mbox{where } m = 120 000 $$

* Manipulating the model
** Defining f(v)

As you can see in [[table_of_differences]] speed for $t \in (0, 9)$ clearly isn't decreasing linearly. And you can see that, as speed decreases (in that interval), the rate at which it decreases also decreases. So it's reasonable to suggest that

$$ f(v) \propto v^2 $$
$$ \Rightarrow f(v) = kv^2 $$
$$ \Rightarrow m\dot{v} = \begin{cases} - kv^2, & 0 \leq t < 9 \\ - kv^2 - B, & 9 \leq t \leq 26 \end{cases} $$

** General solution
*** 0 \leq t < 9

$$ m\dot{v} = -kv^2 $$
$$ m\frac{\dot{v}}{v^2} = -k $$
$$ m\int \frac{\dot{v}}{v^2} dt = -k\int dt $$
$$ m\int v^{-2} dv = -kt + c $$
$$ m\frac{v^{-1}}{-1} = -kt + c $$
$$ \frac{-m}{v} = -kt + c $$
$$ v = \frac{m}{kt - c} $$

*** 9 \leq t \leq 26

$$ m\dot{v} = -kv^2 - B $$
$$ m\frac{\dot{v}}{kv^2 + B} = -1 $$
$$ m\int \frac{\dot{v}}{kv^2 + B} dt = -\int dt $$
$$ m\int \frac{1}{kv^2 + B} dv = -\int dt $$
$$ \arctan'(\psi) = \frac{1}{\psi^2 + 1} $$
$$ \Rightarrow \arctan'(\frac{a}{b}\psi) = \frac{a}{b} \times \frac{1}{(\frac{a}{b}\psi)^2 + 1} = \frac{a}{b} \times \frac{b^2}{a^2\psi^2 + b^2} = \frac{ab}{a^2\psi^2 + b^2} $$
$$ \Rightarrow \arctan'(\sqrt{\frac{a}{b}}\psi) = \frac{\sqrt{ab}}{a\psi^2 + b} $$
$$ \Rightarrow \int \frac{1}{kv^2 + B} dv = \frac{1}{\sqrt{kB}}\int \frac{\sqrt{kB}}{kv^2 + B} = \frac{\arctan(\sqrt{\frac{k}{B}}v)}{\sqrt{kB}} + c $$
$$ \Rightarrow \frac{m\arctan(\sqrt{\frac{k}{B}}v)}{\sqrt{kB}} = -t + c $$
$$ \Rightarrow \sqrt{\frac{k}{B}}v = \tan \frac{\sqrt{kB}(-t + c)}{m} $$
$$ \Rightarrow v = \sqrt{\frac{B}{k}} \tan \frac{\sqrt{kB}(-t + c)}{m} $$
$$ \mbox{Let } c_1 = \sqrt{kB}c $$
$$ \Rightarrow v = \sqrt{\frac{B}{k}} \tan \frac{c_1 -\sqrt{kB}t}{m} $$

** Particular solution

To make $v$ continuous I will use point $(t = 9, v = 55)$.

$$ \begin{cases} \sqrt{\frac{B}{k}} \tan \frac{c_2 - 9\sqrt{kB}}{m} = 55 \\ \frac{m}{9k - c_1} = 55 \end{cases} $$
$$ \Rightarrow 9k - c_1 = \frac{m}{55} $$
$$ \Rightarrow k = \frac{c_1 + \frac{m}{55}}{9} $$
$$ S \mbox{ is the set of given data.} $$
$$ (t_1, v_1), (t_2, v_2) \in S; t_1, t_2 \leq 9, t_1 \neq t_2 $$
$$ \begin{cases} v_1 = \frac{m}{t_1k - c_1} \\ v_2 = \frac{m}{t_2k - c_1} \end{cases} $$
$$ \Rightarrow \begin{cases} v_1v_2t_2t_1k - v_1v_2t_2c_1 = mv_2t_2 \\ v_1v_2t_1t_2k  - v_1v_2t_1c_1 = mv_1t_1 \end{cases} $$
$$ \Rightarrow c_1v_1v_2(t_2 - t_1) = m(v_1t_1 - v_2t_2) $$
$$ \Rightarrow c_1 = \frac{m(v_1t_1 - v_2t_2)}{v_1v_2(t_2 - t_1)} $$
$$ \sqrt{\frac{B}{k}} \tan \frac{c_2 - 9\sqrt{kB}}{m} = 55 $$
$$ \Rightarrow c_2(B) = m\arctan(\frac{55k\sqrt{\frac{B}{k}}}{B}) + 9\sqrt{Bk} $$
$$ (t_3, v_3) \in S; t_3 > 9 $$
$$ \Rightarrow v_3 = \sqrt{\frac{B}{k}} \tan \frac{c_2(B) - \sqrt{kB}t_3}{m} $$
$$ \Rightarrow \arctan(v_3\sqrt{\frac{k}{B}}) = \frac{c_2(B) - \sqrt{kB}t_3}{m} $$
$$ \mbox{Let } \lambda(B) = \frac{c_2(B) - \sqrt{kB}t_3}{m} - \arctan(v_3\sqrt{\frac{k}{B}}) $$
$$ \mbox{Newton-Raphson's rule: } B_{n+1} = B_n + \frac{\lambda'(B_n)}{\lambda(B_n)} $$
$$ c_1 = \frac{m(v_1t_1 - v_2t_2)}{v_1v_2(t_2 - t_1)} $$
$$ k = \frac{c_1 + \frac{m}{55}}{9} $$
$$ c_2(B) = m\arctan(\frac{55k\sqrt{\frac{B}{k}}}{B}) + 9\sqrt{Bk} $$
$$ B_{n+1} = B_n - \frac{\lambda(B_n)}{\lambda'(B_n)} $$

* The collection of data to verify the model
* Comparison between the data collected and the predictions of the model
* Revision of the model
** General solution
*** 9 < t \leq 26

$$ m\dot{v} = -kv^2 - \lambda v - W $$
$$ \Rightarrow m\int \frac{1}{kv^2 + \lambda v + W} dv = -\int dt $$
$$ kv^2 + \lambda v + W = (\sqrt{k}v + \frac{\lambda}{2\sqrt{k}})^2 + W - \frac{\lambda^2}{4k} = (W - \frac{\lambda^2}{4k})((\frac{\sqrt{k}v + \frac{\lambda}{2\sqrt{k}}}{\sqrt{W - \frac{\lambda^2}{4k}}})^2 + 1) = (W - \frac{\lambda^2}{4k})((\frac{2kv + \lambda}{\sqrt{4kW - \lambda^2}})^2 + 1) $$
$$ \mbox{Let } h(x) = \frac{2kx + \lambda}{\sqrt{4kW - \lambda^2}} $$
$$ \Rightarrow h'(x) = \frac{2k}{\sqrt{4kW - \lambda^2}} $$
$$ \arctan'(x) = \frac{1}{1 + x^2} $$
$$ \Rightarrow (\arctan(h(x)))' = \arctan'(h(x))h'(x) = \frac{1}{h^2(x) + 1}h'(x) = \frac{\frac{2k}{\sqrt{4kW - \lambda^2}}}{(\frac{2kx + \lambda}{\sqrt{4kW - \lambda^2}})^2 + 1} $$
$$ \Rightarrow m\int \frac{1}{kv^2 + \lambda v + W} dv = m\int \frac{1}{(W - \frac{\lambda^2}{4k})((\frac{2kv + \lambda}{\sqrt{4kW - \lambda^2}})^2 + 1)} dv = \frac{2m\sqrt{4kW - \lambda^2}}{4k(W - \frac{\lambda^2}{4k})}\int \frac{\frac{2k}{\sqrt{4kW - \lambda^2}}}{(\frac{2kv + \lambda}{\sqrt{4kW - \lambda^2}})^2 + 1} dv $$
$$ \Rightarrow \frac{2m}{\sqrt{4kW-\lambda^2}}\arctan(\frac{2kv + \lambda}{\sqrt{4kW - \lambda^2}}) = -t + c_4 $$
$$ \Rightarrow \frac{2kv + \lambda}{\sqrt{4kW - \lambda^2}} = \tan(\frac{\sqrt{4kW-\lambda^2}}{2m}(c_4 - t)) $$
$$ \Rightarrow v = \frac{\sqrt{4kW - \lambda^2}\tan(\frac{\sqrt{4kW-\lambda^2}}{2m}(c_4 - t)) - \lambda}{2k}  $$

*** 0 \leq t < 9

$$ m\dot{v} = -kv^2 - \lambda v $$
$$ \Rightarrow m\int \frac{1}{kv^2 + \lambda v} dv = -t + c_3 $$
$$ kv^2 + \lambda v \equiv v(kv + \lambda)  $$
$$ \frac{1}{v(kv + \lambda)} \equiv \frac{A}{v} + \frac{B}{kv + \lambda} $$
$$ \Rightarrow 1 \equiv A(kv + \lambda) + Bv $$
$$ \Rightarrow \begin{cases} A = \frac{1}{\lambda} \\ B = -\frac{k}{\lambda} \end{cases} $$
$$ \Rightarrow \frac{1}{kv^2 + \lambda v} \equiv \frac{1}{\lambda v} - \frac{k}{k \lambda v + \lambda^2} ( \equiv \frac{k \lambda v + \lambda^2 - k \lambda v}{\lambda v (k \lambda v + \lambda^2)} \equiv \frac{\lambda^2}{\lambda^2(kv^2 + \lambda v)} \equiv \frac{1}{kv^2 + \lambda v} ) $$
$$ \Rightarrow \int \frac{1}{kv^2 - \lambda v} dv = \frac{1}{\lambda}\int v^{-1} dv - \frac{1}{\lambda}\int \frac{k}{kv + \lambda} dv $$
$$ \Rightarrow \frac{m}{\lambda}(\ln(v) - \ln(kv + \lambda)) = c_3 - t $$
$$ \Rightarrow \ln(\frac{v}{kv + \lambda}) = \frac{\lambda}{m} (c_3 - t) $$
$$ \Rightarrow \frac{v}{kv + \lambda} = e^{\frac{\lambda}{m} (c_3 - t)} $$
$$ \Rightarrow v = k e^{\frac{\lambda}{m} (c_3 - t)} v + \lambda e^{\frac{\lambda}{m} (c_3 - t)} $$
$$ v = \frac{\lambda e^{\frac{\lambda}{m} (c_3 - t)}}{1 - k e^{\frac{\lambda}{m} (c_3 - t)}} $$
$$ v = \frac{\lambda e^{\frac{\lambda}{m} c_3}}{e^{\frac{\lambda}{m} t} - ke^{\frac{\lambda}{m}c_3}} $$

* Assessment of the improvement obtained
